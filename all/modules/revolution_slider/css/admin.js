jQuery(document).ready(function(e){jQuery.fn.exists=function(){return this.length>0};if(e(".field-type-revolution-slider-layer").exists()){var t=e("#edit-field-image .image-widget span.file").find("a").attr("href");$subLayer=e(".field-type-revolution-slider-layer table.field-multiple-table tr.draggable:not(:last)");$last=e(".field-type-revolution-slider-layer table.field-multiple-table tr.draggable:last");$current=0;e(".field-type-revolution-slider-slide").after('<div class="preview-bg" />');e("div.preview-bg").css("background-image","url("+t+")").wrap('<div class="slide-builder" style="overflow: hidden;" />');var n=new Image;n.onload=function(){console.log(this.width+"x"+this.height);e(".slide-builder").height(this.height).width(e(".slide-builder").parent().width()).scrollLeft(e(".slide-builder").width()/3);e("div.preview-bg").css("height",this.height).css("width","960px").css("background-position","center");if(this.width>e("slide-builder").parent().width()){}};n.src=t;$last.hide();$subLayer.each(function(){var t=e(this).find("input.edit-revolution_slider-fields-data-x").val();$y=e(this).find("input.edit-revolution_slider-fields-data-y").val();$i=$current++;$slideWrap=e(".slide-builder").find("div.preview-bg");$selected=e(this).find("select.edit-revolution_slider-fields-layer");$img=e(this).find(".form-managed-file span.file").find("a").attr("href");$h1=e(this).find(".edit-revolution_slider-fields-h1-"+$i);e(this).find("input.edit-revolution_slider-fields-data-x").addClass("layer-x-"+$i+"-draggable");e(this).find("input.edit-revolution_slider-fields-data-y").addClass("layer-y-"+$i+"-draggable");e(this).find("select.edit-revolution_slider-fields-layer").addClass("select-"+$i+"-menu");$slideWrap.append('<div class="layer layer-'+$i+'-editor" style="left: '+t+"px; top: "+$y+'px"></div>');switch($selected.val()){case"img":if($img==undefined){e(".layer-"+$i+"-editor").html("New Image")}else{e(".layer-"+$i+"-editor").html('<img src="'+$img+'" />')}break;case"div":e(".layer-"+$i+"-editor").html("div");break;case"h1":e(".layer-"+$i+"-editor").html("<h1>"+$h1.val()+"</h1>");break;case"h2":e(".layer-"+$i+"-editor").html("h2");break;case"h3":e(".layer-"+$i+"-editor").html("h3");break;case"h4":e(".layer-"+$i+"-editor").html("h4");break;case"h5":e(".layer-"+$i+"-editor").html("h5");break;case"h6":e(".layer-"+$i+"-editor").html("h6");break;default:e(".layer-"+$i+"-editor").html("New Layer");break}var n=e(this).index();e(".select-"+n+"-menu").change(function(){$img=e(this).parents().eq(2).find(".form-managed-file span.file").find("a").attr("href");switch(e(this).val()){case"img":if($img==undefined){e(".layer-"+n+"-editor").html("New Image")}else{e(".layer-"+n+"-editor").html('<img src="'+$img+'" />')}break;case"div":e(".layer-"+n+"-editor").html("div");break;case"h1":e(".layer-"+n+"-editor").html("<h1>"+$h1.val()+"</h1>");break;case"h2":e(".layer-"+n+"-editor").html("h2");break;case"h3":e(".layer-"+n+"-editor").html("h3");break;case"h4":e(".layer-"+n+"-editor").html("h4");break;case"h5":e(".layer-"+n+"-editor").html("h5");break;case"h6":e(".layer-"+n+"-editor").html("h6");break;default:e(".layer-"+n+"-editor").html("New Layer");break}});e(".layer-"+n+"-editor").draggable({cursor:"crosshair",containment:"parent",stop:function(t,r){var i=$slideWrap.offset();$pos=r.helper.offset();e(".layer-x-"+n+"-draggable").val($pos.left-i.left);e(".layer-y-"+n+"-draggable").val($pos.top-i.top)}});e("input.layer-x-"+n+"-draggable").keyup(function(){e(".layer-"+n+"-editor").css("left",e(this).val()+"px")});e("input.layer-y-"+n+"-draggable").keyup(function(){e(".layer-"+n+"-editor").css("top",e(this).val()+"px")});$h1.keyup(function(){e(".layer-"+n+"-editor").html("<h1>"+e(this).val()+"</h1>")})});Drupal.behaviors.revolution_slider={attach:function(t,n){$last.show();$last=e(".field-type-revolution-slider-layer table.field-multiple-table tr.draggable:last");$subLayer=e(".field-type-revolution-slider-layer table.field-multiple-table tr.draggable:not(:last)");$index=$last.index()-1;$last.hide();e("input.field-add-more-submit",t).once("revolution_slider",function(){$subLayer.each(function(){$i=e(this).index();e(this).find("input.edit-revolution_slider-fields-data-x").addClass("layer-x-"+$i+"-draggable");e(this).find("input.edit-revolution_slider-fields-data-y").addClass("layer-y-"+$i+"-draggable");e(this).find("select.edit-revolution_slider-fields-layer").addClass("select-"+$i+"-menu");$slideWrap=e(".slide-builder").find("div.preview-bg");$h1=e(this).find(".edit-revolution_slider-fields-h1-"+$i);var t=e(this).index();e(".select-"+t+"-menu").change(function(){$img=e(this).parents().eq(2).find(".form-managed-file span.file").find("a").attr("href");$h1=e(this).parents().eq(2).find(".edit-revolution_slider-fields-h1-"+t);switch(e(this).val()){case"img":if($img!==undefined){e(".layer-"+t+"-editor").html('<img src="'+$img+'" />')}else{e(".layer-"+t+"-editor").html("New Image")}break;case"div":e(".layer-"+t+"-editor").html("div");break;case"h1":e(".layer-"+t+"-editor").html("<h1>"+$h1.val()+"</h1>");break;case"h2":e(".layer-"+t+"-editor").html("h2");break;case"h3":e(".layer-"+t+"-editor").html("h3");break;case"h4":e(".layer-"+t+"-editor").html("h4");break;case"h5":e(".layer-"+t+"-editor").html("h5");break;case"h6":e(".layer-"+t+"-editor").html("h6");break;default:e(".layer-"+t+"-editor").html("New Layer");break}});e(".layer-"+t+"-editor").draggable({cursor:"crosshair",containment:"parent",stop:function(n,r){var i=$slideWrap.offset();$pos=r.helper.offset();e(".layer-x-"+t+"-draggable").val($pos.left-i.left);e(".layer-y-"+t+"-draggable").val($pos.top-i.top)}});e("input.layer-x-"+t+"-draggable").keyup(function(){e(".layer-"+t+"-editor").css("left",e(this).val()+"px")});e("input.layer-y-"+t+"-draggable").keyup(function(){e(".layer-"+t+"-editor").css("top",e(this).val()+"px")});$h1.keyup(function(){e(".layer-"+t+"-editor").html("<h1>"+e(this).val()+"</h1>")})});$newLayer=e("div.preview-bg > .layer-"+$index+"-editor").exists();if($newLayer==false){console.log($newLayer);$slideWrap.append('<div class="layer layer-'+$index+'-editor">New Layer</div>')}e(".preview-bg > div.layer").each(function(){e(".layer-"+$index+"-editor").draggable({cursor:"crosshair",containment:"parent",stop:function(t,n){var r=$slideWrap.offset();$pos=n.helper.offset();e(".layer-x-"+$index+"-draggable").val($pos.left-r.left);e(".layer-y-"+$index+"-draggable").val($pos.top-r.top)}})})});$preview_img=e("#edit-field-image .image-widget span.file").find("a").attr("href");e("#edit-field-image .image-widget input[type='submit']").once(function(){var t=new Image;t.onload=function(){e(".slide-builder").height(this.height).width(e(".slide-builder").parent().width()).scrollLeft(e(".slide-builder").width()/3);e("div.preview-bg").css("height",this.height).css("width","960px").css("background-position","center")};t.src=$preview_img;if($preview_img==undefined){e("div.preview-bg").css("background-image","none")}else{e("div.preview-bg").css("background-image","url("+$preview_img+")")}});$subLayer.each(function(){$i=e(this).index();$img=e(this).find(".form-managed-file span.file").find("a").attr("href");$selected=e(this).find("select.edit-revolution_slider-fields-layer");e(".edit-revolution_slider-fields-image-"+$i+" > input[type='submit'], .edit-revolution_slider-fields-image-"+$i+" > input[type='submit']").once(function(){if($img==undefined&&$selected.val()=="img"){e(".layer-"+$i+"-editor").html("New Image");console.log($selected.val()+$i)}else if($img!==undefined&&$selected.val()=="img"){e(".layer-"+$i+"-editor").html('<img src="'+$img+'" />');console.log($selected.val()+$i)}})})}}}})